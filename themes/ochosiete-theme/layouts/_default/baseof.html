<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{{ if .Description }}{{ .Description }}{{ else }}{{ .Site.Params.description }}{{ end }}">
    <meta name="author" content="{{ .Site.Params.author }}">
    
    <!-- Open Graph -->
    <meta property="og:title" content="{{ if .Title }}{{ .Title }} • {{ end }}{{ .Site.Title }}">
    <meta property="og:description" content="{{ if .Description }}{{ .Description }}{{ else }}{{ .Site.Params.description }}{{ end }}">
    <meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
    <meta property="og:url" content="{{ .Permalink }}">
    {{ if .Params.image }}
    <meta property="og:image" content="{{ .Params.image | absURL }}">
    {{ end }}
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ if .Title }}{{ .Title }} • {{ end }}{{ .Site.Title }}">
    <meta name="twitter:description" content="{{ if .Description }}{{ .Description }}{{ else }}{{ .Site.Params.description }}{{ end }}">
    
    <title>{{ if .Title }}{{ .Title }} • {{ end }}{{ .Site.Title }}</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Styles -->
    {{ $css := resources.Get "css/main.css" }}
    <link rel="stylesheet" href="{{ $css.RelPermalink }}">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- PWA Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="87">
    <link rel="apple-touch-icon" href="/images/pwa/icon-192x192.png">
    <meta name="theme-color" content="#C41E3A">
    <meta name="msapplication-TileColor" content="#C41E3A">
    <meta name="msapplication-TileImage" content="/images/pwa/icon-144x144.png">
    
    <!-- RSS -->
    {{ with .OutputFormats.Get "RSS" }}
    <link href="{{ .RelPermalink }}" rel="alternate" type="application/rss+xml" title="{{ $.Site.Title }}">
    {{ end }}
</head>
<body>
    <div class="site-container">
        {{ partial "header.html" . }}
        
        <main class="site-content">
            {{ block "main" . }}{{ end }}
        </main>
        
        {{ partial "footer.html" . }}
    </div>
    
    <!-- Dark Mode Toggle Script -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
    <script>
        // Inicializar tema desde localStorage o preferencia del sistema
        const initTheme = () => {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const theme = savedTheme || (prefersDark ? 'dark' : 'light');
            document.documentElement.setAttribute('data-theme', theme);
            return theme;
        };
        
        // Toggle tema
        const toggleTheme = () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        };
        
        // Inicializar al cargar
        initTheme();
        
        // Event listener para el botón
        document.addEventListener('DOMContentLoaded', () => {
            const themeToggle = document.getElementById('theme-toggle');
            if (themeToggle) {
                themeToggle.addEventListener('click', toggleTheme);
            }
        });
    </script>
    
    <!-- Mobile Menu Script -->
    {{ $mobileMenu := resources.Get "js/mobile-menu.js" }}
    <script src="{{ $mobileMenu.RelPermalink }}" defer></script>
    
    <!-- Swipe Navigation Script -->
    {{ $swipeNav := resources.Get "js/swipe-navigation.js" }}
    <script src="{{ $swipeNav.RelPermalink }}" defer></script>
    
    {{ block "scripts" . }}{{ end }}
</body>
</html>
